(this.webpackJsonpultrasound=this.webpackJsonpultrasound||[]).push([[1],{13:function(e,t,n){"use strict";var r=n(21),c=n(2),a={setMessage:function(e){return{type:c.j,payload:e}},clearMessage:function(){return{type:c.a}}},s=n(7),o={getClassifications:function(){return s.a.get("".concat("http://localhost:8080/api","/video/classifications"))}}.getClassifications,i={categories:function(e){return{type:c.h,payload:e}},classifications:function(){return function(e){return o().then((function(t){e({type:c.i,payload:t})}))}}},u={auth:r.a,message:a,videos:i};t.a=u},16:function(e,t,n){"use strict";var r={getLocalRefreshToken:function(){var e=JSON.parse(localStorage.getItem("user"));return null===e||void 0===e?void 0:e.refreshToken},getLocalAccessToken:function(){var e=JSON.parse(localStorage.getItem("user"));return null===e||void 0===e?void 0:e.accessToken},updateLocalAccessToken:function(e){var t=JSON.parse(localStorage.getItem("user"));t.accessToken=e,localStorage.setItem("user",JSON.stringify(t))},getUser:function(){return JSON.parse(localStorage.getItem("user"))},setUser:function(e){localStorage.setItem("user",JSON.stringify(e))},removeUser:function(){localStorage.removeItem("user")}};t.a=r},2:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"f",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"j",(function(){return i})),n.d(t,"a",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return f})),n.d(t,"e",(function(){return d}));var r="REGISTER_SUCCESS",c="REGISTER_FAIL",a="LOGIN_SUCCESS",s="LOGIN_FAIL",o="LOGOUT",i="SET_MESSAGE",u="CLEAR_MESSAGE",l="SET_CATEGORIES",f="SET_CLASSIFICATIONS",d="REFRESH_TOKEN"},21:function(e,t,n){"use strict";var r=n(7),c=n(16).a.removeUser,a={registerService:function(e){return r.a.post("/auth/sign-up",e)},loginService:function(e){return r.a.post("/auth/sign-in",e).then((function(e){return e.data&&localStorage.setItem("user",JSON.stringify(e.data)),e.data}))},logoutService:function(){c()}},s=n(2),o=a.registerService,i=a.loginService,u=a.logoutService,l={refreshToken:function(e){return function(t){t({type:s.e,payload:e})}},login:function(e){return function(t){return i(e).then((function(e){t({type:s.c,payload:{user:e}})}),(function(e){var n=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();return t({type:s.b}),t({type:s.j,payload:n}),Promise.reject(e)}))}},register:function(e){return function(t){return o(e).then((function(e){t({type:s.g}),t({type:s.j,payload:e.data.message})}),(function(e){var n=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();return t({type:s.f}),t({type:s.j,payload:n}),Promise.reject()}))}},logout:function(){return function(e){u(),e({type:s.d})}}};t.a=l},41:function(e,t,n){"use strict";n(0);var r=n(8),c=n(13),a=n(1);t.a=function(){var e=Object(r.b)();return Object(a.jsx)("div",{className:"form-group",style:{marginLeft:"1rem"},children:Object(a.jsx)("button",{type:"button",className:"btn btn-outline-primary",onClick:function(){return e(c.a.auth.logout())},children:"Logout"})})}},42:function(e,t,n){"use strict";var r=n(7),c={getPublicContent:function(){return r.a.get("/all")},getClassifications:function(){return r.a.get("/classifications")},getAdminContent:function(){return r.a.get("/admin")}};t.a=c},7:function(e,t,n){"use strict";var r=n(22),c=n.n(r),a=c.a.create({baseURL:"http://localhost:8080/api",headers:{"Content-Type":"application/json"}});a.CancelToken=c.a.CancelToken,a.isCancel=c.a.isCancel,t.a=a},74:function(e,t,n){},75:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(19),a=n.n(c),s=n(8),o=n(26),i=n.n(o),u=n(31),l=n(7),f=n(16),d=n(13),j=f.a.getLocalAccessToken,b=f.a.getLocalRefreshToken,p=f.a.updateLocalAccessToken,g=function(e){l.a.interceptors.request.use((function(e){var t=j();return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(function(e){return l.a.isCancel(!0),Promise.reject(e)}));var t=e.dispatch;l.a.interceptors.response.use((function(e){return e}),function(){var e=Object(u.a)(i.a.mark((function e(n){var r,c,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("/auth/sign-in"===(r=n.config).url||!n.response){e.next=17;break}if(401!==n.response.status||r.retry){e.next=17;break}return r.retry=!0,e.prev=4,e.next=7,l.a.post("/auth/token/refresh",{refreshToken:b()});case 7:return c=e.sent,a=c.data.accessToken,t(d.a.auth.refreshToken(a)),p(a),e.abrupt("return",Object(l.a)(r));case 14:return e.prev=14,e.t0=e.catch(4),e.abrupt("return",Promise.reject(e.t0));case 17:return e.abrupt("return",Promise.reject(n));case 18:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}())},h=n(15),O=n(43),v=n(44),m=n(5),y=n(2),S=JSON.parse(localStorage.getItem("user")),x=S?{isAuth:!0,user:S}:{isAuth:!1,user:null},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;console.log("%c Current action: %c".concat(JSON.stringify(t.type)," "),"font-size: 12px; color: black; background: lightGrey;","font-size: 12px; color: DarkGreen; background: lightGrey;");var n=t.type,r=t.payload;switch(n){case y.e:return Object(m.a)(Object(m.a)({},e),{},{user:Object(m.a)(Object(m.a)({},S),{},{accessToken:r})});case y.g:case y.f:return Object(m.a)(Object(m.a)({},e),{},{isAuth:!1});case y.c:return Object(m.a)(Object(m.a)({},e),{},{isAuth:!0,user:r});case y.b:case y.d:return Object(m.a)(Object(m.a)({},e),{},{isAuth:!1,user:null});default:return e}},T={},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case y.j:return{message:r};case y.a:return{message:""};default:return e}},C={categories:[],classifications:[]},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case y.h:return Object(m.a)(Object(m.a)({},e),{},{categories:r.data});case y.i:return Object(m.a)(Object(m.a)({},e),{},{classifications:r.data});default:return e}},L=Object(h.combineReducers)({auth:k,message:E,videos:N}),A=Object(h.createStore)(L,Object(O.composeWithDevTools)(Object(h.applyMiddleware)(v.a))),I=(n(74),n(75),n(6)),R=Object(I.a)(),G=n(4),J=n(29),w=n(18),_=n(1),z=function(){return Object(_.jsx)(w.a,{to:"/home",children:Object(_.jsx)("div",{className:"list-item",style:{color:"black",backgroundColor:"#f8f9fa",borderRight:"none"},children:"Home"})})},P=Object(r.lazy)((function(){return n.e(7).then(n.bind(null,239))})),U=function(){var e=Object(s.c)((function(e){return e.videos})).classifications;return e&&0!==e.length?Object(_.jsxs)("div",{className:"sidebar-content",children:[Object(_.jsx)(z,{}),Object(_.jsx)(r.Suspense,{fallback:"Loading...",children:Object(_.jsx)(P,{classifications:e})})]}):"Loading..."},M=function(){return Object(_.jsx)("div",{className:"sidebar",children:Object(_.jsx)(U,{})})},F=function(){return Object(_.jsx)("div",{})},q=function(){return Object(_.jsx)("div",{className:"footer",children:"caleb tracey 2021"})},D=n(41),H=function(){var e=Object(s.c)((function(e){return e.auth})).user;return Object(_.jsx)("div",{className:"form-group",children:e.username})},B=function(){return Object(_.jsx)("div",{className:"header",children:Object(_.jsxs)("div",{className:"button-wrapper",children:[Object(_.jsx)(D.a,{}),Object(_.jsx)(H,{})]})})},K=function(){return Object(_.jsxs)("div",{className:"body",children:[Object(_.jsx)(B,{}),Object(_.jsx)(F,{}),Object(_.jsx)(q,{})]})},W=n(42),Q={on:function(e,t){document.addEventListener(e,(function(e){return t(e.detail)}))},dispatch:function(e,t){document.dispatchEvent(new CustomEvent(e,{detail:t}))},remove:function(e,t){document.removeEventListener(e,t)}},V=W.a.getClassifications,X=Object(G.g)((function(){var e=Object(r.useState)({}),t=Object(J.a)(e,2),n=t[0],c=t[1],a=Object(s.c)((function(e){return e.auth})).user,o=Object(s.b)();return a||G.a,Object(r.useEffect)((function(){V().then((function(e){o(d.a.videos.classifications(e.data)),c(e.data)}),(function(e){var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();c(t),e.response&&401===e.response.status&&Q.dispatch("logout")}))}),[o]),Object(_.jsxs)("div",{className:"app",children:[Object(_.jsx)(M,{content:n}),Object(_.jsx)(K,{})]})})),Y=Object(r.lazy)((function(){return n.e(6).then(n.bind(null,236))})),Z=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(5)]).then(n.bind(null,237))})),$=Object(r.lazy)((function(){return n.e(8).then(n.bind(null,235))})),ee=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,238))})),te=function(){return Object(_.jsx)(G.c,{history:R,children:Object(_.jsxs)(G.d,{children:[Object(_.jsx)(G.b,{exact:!0,path:["/","/home"],component:Y}),Object(_.jsx)(G.b,{exact:!0,path:"/login",component:Z}),Object(_.jsx)(G.b,{exact:!0,path:"/register",component:ee}),Object(_.jsx)($,{exact:!0,path:"/dashboard",component:X})]})})},ne=n(21),re=function(){var e=Object(s.c)((function(e){return e.auth})).user,t=Object(s.b)(),n=Object(r.useCallback)((function(){t(Object(ne.a)())}),[t]);return Object(r.useEffect)((function(){R.listen((function(e){t({type:y.a})}))}),[t]),Object(r.useEffect)((function(){return Q.on("logout",(function(){n()})),function(){Q.remove("logout")}}),[e,t,n]),Object(_.jsx)(r.Suspense,{fallback:"Loading...",children:Object(_.jsx)("div",{className:"app",children:Object(_.jsx)(te,{})})})};g(A),a.a.render(Object(_.jsx)(s.a,{store:A,children:Object(_.jsx)(re,{})}),document.querySelector("#root"))}},[[78,2,3]]]);
//# sourceMappingURL=main.64eb49ad.chunk.js.map